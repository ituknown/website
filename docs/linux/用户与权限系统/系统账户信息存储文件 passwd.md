## å‰è¨€

$Linux$ ç³»ç»Ÿæ–‡ä»¶ `/etc/passwd` å­˜å‚¨çš„æ˜¯ç³»ç»Ÿç”¨æˆ·çš„æ•°æ®ä¿¡æ¯ï¼Œå› ä¸ºè¿™ä¸ªæ–‡ä»¶åä¸ç³»ç»Ÿç”¨äºç®¡ç†ç”¨æˆ·å¯†ç çš„å‘½ä»¤ `passwd` åŒåï¼Œæ‰€ä»¥å¼€å§‹æˆ‘ç†æ‰€å½“ç„¶çš„ä»¥ä¸ºè¿™ä¸ªæ–‡ä»¶å­˜å‚¨çš„å°±æ˜¯ç”¨æˆ·çš„å¯†ç ç›¸å…³ä¿¡æ¯ã€‚å…¶å®ä¸æ˜¯çš„ï¼Œå®ƒçœŸæ­£å­˜å‚¨çš„æ˜¯ç”¨æˆ·çš„è´¦æˆ·ä¿¡æ¯ã€‚

äº‹å®ä¸Šåœ¨ä»¥å‰çš„ Linux ä¸­ï¼Œ`/etc/passwd` ä¸­ç¡®å®å­˜å‚¨ç”¨æˆ·çš„å¯†ç ä¿¡æ¯ã€‚åªä¸è¿‡ç°ä»£ Linux ç³»ç»Ÿä¸ºäº†å®‰å…¨æ€§ï¼Œå°†å¯†ç ä¿¡æ¯å…¨éƒ¨ç§»åŠ¨åˆ°äº† `/etc/shadow` æ–‡ä»¶ï¼Œåœ¨ `/etc/passwd` æ–‡ä»¶ä¸­è™½ç„¶è¿˜ä¿ç•™ç€å¯†ç ä½ï¼Œä½†ä½¿ç”¨çš„æ˜¯ x å­—ç¬¦æ ‡è¯†ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸ªæ–‡ä»¶åå« `passwd` çš„åŸå› ã€‚

:::tip
`/etc/passwd` æ–‡ä»¶ä¸ç³»ç»Ÿç”¨æˆ·æœ‰å…³ï¼Œæ‰€ä»¥åƒä¸‡ä¸è¦ä½¿ç”¨ `root` ç”¨æˆ·æˆ–å…·æœ‰è¶…çº§ç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·ç›´æ¥ç¼–è¾‘è¯¥æ–‡ä»¶æ•°æ®ã€‚å¦è€…å¯èƒ½æŸäº›ç”¨æˆ·ä¸å¯ç”¨çš„é—®é¢˜ï¼Œå¾—ä¸å¿å¤±ã€‚
:::

## æ•°æ®æ ¼å¼

è™½ç„¶ä¸èƒ½ç›´æ¥ç¼–è¾‘è¯¥æ–‡ä»¶ï¼Œä½†æ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨ cat ç­‰å‘½ä»¤æŸ¥çœ‹è¯¥æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œå› ä¸ºè¯¥æ–‡ä»¶çš„æƒé™æ˜¯ 644ï¼ˆ`rw-r--r--`ï¼‰ï¼š

```bash
$ ls -l /etc/passwd
-rw-r--r-- 1 root root 1914 Nov 29 14:31 /etc/passwd
```

ç›´æ¥åœ¨å±å¹•ä¸Šä½¿ç”¨ cat å‘½ä»¤æ‰“å° `/etc/passwd` æ–‡ä»¶å†…å®¹çš„è¯å¯èƒ½ä¼šæ„Ÿè§‰æ˜¯ä¸€å¨æ‚ä¹±æ— ç« çš„æ•°æ®ã€‚ä½†å…¶å®è¯¥æ–‡ä»¶ä¸­æ¯ä¸€è¡Œå°±æ˜¯ä¸€ä¸ªç”¨æˆ·çš„è´¦æˆ·ä¿¡æ¯ï¼Œå¹¶ä¸”æ¯è¡Œçš„æ•°æ®æ ¼å¼ä¹Ÿæ˜¯å›ºå®šçš„ã€‚

æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼ˆ`:` ç¬¦å·æ˜¯åˆ†éš”ç¬¦ï¼‰ï¼š


```
kali:x:1000:1000:kali,,,:/home/kali:/bin/bash
[--] - [--] [--] [-----] [--------] [-------]
|    |  |    |      |         |         |
|    |  |    |      |         |         +-------> 7. Shell
|    |  |    |      |         +-----------------> 6. Home Directory
|    |  |    |      +---------------------------> 5. Username comment
|    |  |    +----------------------------------> 4. GID
|    |  +---------------------------------------> 3. UID
|    +------------------------------------------> 2. Password
+-----------------------------------------------> 1. Username
```


æ¯ä¸€è¡Œä¸€å…±æœ‰å…­ä¸ª `:` åˆ†éš”ç¬¦ï¼Œä¸ƒä¸ªæ•°æ®ã€‚ä»å·¦åˆ°å³åˆ†åˆ«æ˜¯ï¼šç”¨æˆ·åï¼ˆ`Username`ï¼‰ã€å¯†ç ï¼ˆ`Passwd`ï¼‰ã€ç”¨æˆ·IDï¼ˆ`UID`ï¼‰ã€ç”¨æˆ·ç»„IDï¼ˆ`GID`ï¼‰ã€ç”¨æˆ·çš„æ³¨é‡Šä¿¡æ¯ï¼ˆ`Username comment`ï¼‰ã€ç”¨æˆ·Homeç›®å½•ï¼ˆ`Home Directory`ï¼‰ä»¥åŠæ“ä½œ Shellã€‚

|**Note**|
|:-----|
|ä¸‹é¢ä¼šåšç›¸åº”çš„æ¼”ç¤ºè¯´æ˜ï¼Œç‰¹åˆ«æ³¨æ„çš„æ˜¯ã€‚ä¸‹é¢çš„å‘½ä»¤éœ€è¦ä½¿ç”¨è¶…çº§ç®¡ç†å‘˜ç”¨æˆ· `root` æˆ–å…·æœ‰è¶…çº§ç®¡ç†å‘˜è§’è‰²çš„ç”¨æˆ·æ‰èƒ½æ‰§è¡Œï¼|


## ç”¨æˆ·å

è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬åˆ›å»ºçš„ç³»ç»Ÿç”¨æˆ·çš„ç”¨æˆ·åï¼Œç”¨äºç³»ç»Ÿç™»å½•çš„ç”¨æˆ·ã€‚è¿™ä¸ªç”¨æˆ·ååœ¨ç³»ç»Ÿä¸­æ˜¯å”¯ä¸€çš„ï¼Œç”¨æˆ·åçš„æœ€å¤§é•¿åº¦é€šå¸¸ä¸èƒ½è¶…è¿‡32ä¸ªå­—ç¬¦ã€‚

ä¸‹é¢æ˜¯ä½¿ç”¨ `useradd` å‘½ä»¤æ–°å¢ä¸€ä¸ªç”¨æˆ·çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬åˆ›å»ºçš„æ–°ç”¨æˆ·çš„ç”¨æˆ·åæ˜¯ï¼š`exampleuser`ï¼Œç¤ºä¾‹ï¼š

$1.$ å…ˆä½¿ç”¨ id å‘½ä»¤æŸ¥çœ‹ç”¨æˆ· `exampleuser` åœ¨ç³»ç»Ÿä¸­æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨çš„è¯å…ˆåˆ é™¤

```bash
$ id exampleuser
id: â€˜exampleuserâ€™: no such user <== ç”¨æˆ·ä¸å­˜åœ¨, å¦‚æœå­˜åœ¨çš„è¯éœ€è¦ä½¿ç”¨ userdel å‘½ä»¤åˆ é™¤
```

$2.$ åˆ›å»º `exampleuser` ç”¨æˆ·

```bash
useradd exampleuser
```

$3.$ æŸ¥çœ‹ `/etc/passwd` æ–‡ä»¶ä¿¡æ¯

```bash
$ grep exampleuser /etc/passwd
exampleuser:x:1003:1003::/home/exampleuser:/bin/sh
[---------]
     |
     +------------------------------> æˆ‘ä»¬æ–°å»ºçš„ç”¨æˆ·
```

|**Note**|
|:-------|
|ä¹‹åçš„ç¤ºä¾‹ä¸­ä¼šçœç•¥ `grep [username] /etc/passwd` å‘½ä»¤|


## å¯†ç 

è¿™ä¸ªåŸæœ¬å­˜å‚¨çš„æ˜¯ç”¨æˆ·çš„å¯†ç åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼Œåªä¸è¿‡ç°åœ¨å·²ç»å°†å¯†ç ç§»åˆ° `/etc/shadow` æ–‡ä»¶ä¸­äº†ã€‚æ‰€ä»¥è¿™é‡Œä½ é€šå¸¸ä¼šçœ‹åˆ°ä¸€ä¸ª `x` å­—ç¬¦ï¼Œè¡¨ç¤ºå¯†ç åœ¨ `/etc/shadow` æ–‡ä»¶ä¸­ã€‚

ä»¥ [ç”¨æˆ·å](#ç”¨æˆ·å) ä¸­åˆ›å»ºçš„ `exampleuser` ç”¨æˆ·ä¸ºä¾‹ï¼š

```
exampleuser:x:1003:1003::/home/exampleuser:/bin/sh
            -
            |
            +-------------------------> å¯†ç æ•°æ®, è¢« x æ ‡è¯†, è¯´æ˜å¯†ç å­˜å‚¨åœ¨ /etc/shadow æ–‡ä»¶ä¸­
```

## ç”¨æˆ·ID

è¿™ä¸ªå°±æ˜¯ç”¨æˆ·çš„å”¯ä¸€IDï¼Œåœ¨ POSIX æ ‡å‡†ä¸­ï¼Œè¦æ±‚ UID ä¸ºæ•´æ•°ç±»å‹ï¼Œè€Œå¤§å¤šæ•°ç±» UNIX æ“ä½œç³»ç»Ÿéƒ½é‡‡ç”¨æ— ç¬¦å·æ•´å½¢æ•°å€¼ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šçœ‹åˆ° UID æ˜¯æ•°å€¼çš„åŸå› ã€‚

å¦å¤–ï¼Œä¸€äº› UNIX ç³»ç»Ÿ UID é‡‡ç”¨ 15ä½æ•´å½¢æ•°å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´æœ€å¤§å…è®¸åˆ†é…çš„æ•°å€¼ä¸º $UIDmax=2^{15}-1$ï¼Œå³ 32767ã€‚è€Œåœ¨ Linux v2.4 å†…æ ¸ä¹‹å‰çš„å‘è¡Œç‰ˆé‡‡ç”¨çš„éƒ½æ˜¯ 16 ä½æ•´å½¢æ•°å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´æœ€å¤§å…è®¸åˆ†é…çš„æ•°å€¼ä¸º $UID_{max}=2^{16}$ï¼Œå³ 65536ã€‚

ä½†æ˜¯å‘¢ï¼Œç§‘æŠ€åœ¨è¿›æ­¥ï¼Œç°åœ¨çš„æ“ä½œç³»ç»Ÿæ¶æ„ä¹Ÿåœ¨ä¸æ–­çš„æ¼”è¿›ã€‚ä»¥å‰ç³»ç»Ÿéƒ½æ˜¯ 32 ä½ï¼Œç°åœ¨åŸºæœ¬ä¸Šéƒ½æ˜¯ 64 ä½æ¶æ„æ“ä½œç³»ç»Ÿï¼ˆx86_64 æ¶æ„ï¼‰ã€‚è€Œåœ¨ 64ä½æ¶æ„çš„ç°åœ¨æ“ä½œç³»ç»Ÿï¼Œæ•´å½¢æ•°æ®ç»“æ„åœ¨å†…å­˜ä¸­åŸºæœ¬ä¸Šéƒ½å ç”¨ 32 ä½ï¼Œæ‰€ä»¥ç°åœ¨UIDæœ€å¤§å…è®¸åˆ†é…çš„æ•°å€¼æ˜¯ï¼š$UID_{max}=2^{32}$ï¼Œå³ 4,294,967,296ã€‚

å½“ç„¶è¿™æ˜¯éƒ½æ˜¯ç†è®ºä¸Šçš„ï¼Œå®é™…ä¸Šä¸åŒçš„ Linux å‘è¡Œç‰ˆéƒ½ä¼šå¯¹æœ€å¤§å…è®¸åˆ†é…çš„ UID åšä¸€å®šçš„é™åˆ¶ã€‚è¿™äº›é™åˆ¶è¢«å®šä¹‰åœ¨ `/etc/login.defs` é…ç½®æ–‡ä»¶ä¸­ï¼Œæ¯”å¦‚æŸ¥çœ‹ UID çš„é™åˆ¶ï¼š

```bash
$ grep UID /etc/login.defs
UID_MIN			 1000    ## å…è®¸åˆ›å»ºçš„UIDçš„æœ€å°å€¼
UID_MAX			60000    ## å…è®¸åˆ›å»ºçš„UIDçš„æœ€å¤§å€¼
#SYS_UID_MIN		  100    ## ç³»ç»Ÿç”¨æˆ·UIDå…è®¸æœ€å°å€¼
#SYS_UID_MAX		  999    ## ç³»ç»Ÿç”¨æˆ·UIDå…è®¸æœ€å¤§å€¼
```

--

å…³äº UID çš„å–å€¼å¤§å®¶éœ€è¦äº†è§£ä¸‹ï¼š

**è¶…çº§ç®¡ç†å‘˜ç”¨æˆ· root çš„ UID æ˜¯ 0**ï¼Œè¿™ä¹Ÿè¡¨ç¤º root ç”¨æˆ·æ˜¯ç³»ç»Ÿçš„æœ€é«˜æƒé™ï¼š

```
root:x:0:0:root:/root:/bin/bash
       -
       |
       +--------------------------> root çš„ UID
```

åœ¨ Linux æ ‡å‡†ä¸­ï¼Œ1 ~ 99 èŒƒå›´çš„ UID æ˜¯ç”±ç³»ç»Ÿé™æ€åˆ†é…ï¼Œ100 ~ 1000 åˆ™æ˜¯ä¿ç•™ç»™è¶…çº§ç®¡ç†å‘˜åˆ†é…ä»¥åŠç”¨äºå®‰è£…è„šæœ¬è‡ªåŠ¨åˆ†é…ï¼Œè‡ª 1000 å¼€å§‹çš„ UID æ‰æ˜¯å¯ç”¨äºæˆ‘ä»¬åˆ›å»ºçš„æ™®é€šç”¨æˆ·ä½¿ç”¨çš„ UIDã€‚

ç®€å•ç‚¹ï¼Œå°±è®°ä½ 1000 ä»¥ä¸‹çš„ UID æ˜¯ç”¨äºç³»ç»Ÿä½¿ç”¨ï¼Œ1000 ä»¥ä¸Šæ‰æ˜¯ç”¨äºåˆ›å»ºæ™®é€šç”¨æˆ·ä½¿ç”¨çš„ UIDï¼Œå…³äºè¿™ç‚¹ä¼šåœ¨ `useradd` å‘½ä»¤ä¸­è¿›è¡Œè¯´æ˜ã€‚

æ¯”å¦‚æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„ `exampleuser` ç”¨æˆ·ï¼Œå®ƒçš„ UID ä¸º 1003ï¼š

```
exampleuser:x:1003:1003::/home/exampleuser:/bin/sh
              [--]
               |
               +-----------------------------> UID
```

å†æ¯”å¦‚æˆ‘ä»¬é‡æ–°ä½¿ç”¨ `useradd` å‘½ä»¤åˆ›å»ºä¸€ä¸ªç³»ç»Ÿç”¨æˆ· `examplesysuser`ï¼š

```bash
$ useradd -r examplesysuser

$ grep examplesysuser /etc/passwd
examplesysuser:x:998:997::/home/examplesysuser:/bin/sh
                 [-]
                  |
                  +--------------------> æ­¤æ—¶çš„UIDå°äº 1000
```


## ç”¨æˆ·ç»„ID

æ¯ä¸ªç”¨æˆ·åˆå§‹éƒ½ä¼šé»˜è®¤åˆ†é…ä¸€ä¸ªä¸ç”¨æˆ·åŒåçš„ç”¨æˆ·ç»„ï¼Œè¿™ä¸ªç»„æˆ‘ä»¬ä¸€èˆ¬ç§°ä¸ºä¸»è¦ç»„ï¼Œè¿™ä¸ªæ•°æ®è®°å½•çš„å°±æ˜¯ä¸»è¦ç»„çš„IDï¼š

```
exampleuser:x:1003:1003::/home/exampleuser:/bin/sh
                   [--]
                    |
                    +----------> ç»„ID
```

ä½ å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œè¿™é‡Œåªè®°å½•ä¸€ä¸ªç»„IDï¼Œé‚£å¦‚æœæŸä¸ªç”¨æˆ·æœ‰å¤šä¸ªç»„å‘¢ï¼Ÿå¥½é—®é¢˜ï¼Œä¸è¿‡è¿™ä¸ªé—®é¢˜ä¼šæœ‰ä¸€ä¸ªä¸“é—¨åšæ–‡ä»‹ç»ï¼Œå…·ä½“æ˜¯è§[ä¸»è¦ç»„ä¸æ™®é€šç»„çš„åŒºåˆ«](./ä¸»è¦ç»„ä¸æ™®é€šç»„çš„åŒºåˆ«.md)ã€‚

åæ­£å‘¢ï¼Œè¿™é‡Œä½ åªéœ€è¦è®°ä½ï¼Œåœ¨ `/etc/passwd` æ–‡ä»¶ä¸­è®°å½•çš„ç”¨æˆ·ç»„æ˜¯è¯¥ç”¨æˆ·çš„ä¸»è¦ç»„ï¼Œä¸æ–‡ä»¶çš„æƒé™æœ‰å…³å³å¯ã€‚


## ç”¨æˆ·çš„æ³¨é‡Šä¿¡æ¯

è¿™ä¸ªå°±æ˜¯åˆ›å»ºç”¨æˆ·æ—¶è®¾ç½®çš„ç®€å•æ³¨é‡Šä¿¡æ¯ï¼Œå¯çœç•¥ã€‚æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„ `exampleuser` å°±æ²¡æœ‰æ³¨é‡Šä¿¡æ¯ï¼š

```
exampleuser:x:1003:1003::/home/exampleuser:/bin/sh
                       |
                       |
                       +-----------------> æ— æ³¨é‡Šä¿¡æ¯
```

ç°åœ¨æ¥ä½¿ç”¨ `usermod` å‘½ä»¤æ·»åŠ ä¸‹æ³¨é‡Šï¼š

```bash
usermod -c "Linux Example User" exampleuser
```

å†æ¥çœ‹ä¸‹ï¼š

```
exampleuser:x:1003:1003:Linux Example User:/home/exampleuser:/bin/sh
                        [----------------]
                                |
                                +--------------------> åˆšæ·»åŠ çš„æ³¨é‡Šä¿¡æ¯
```


## ç”¨æˆ·Homeç›®å½•

è¿™ä¸ªæ˜¯ç”¨æˆ·çš„è·Ÿç›®å½•ï¼Œé™¤äº†è¶…çº§ç®¡ç†å‘˜ç”¨æˆ· `root` å¤–ã€‚å…¶ä»–ç”¨æˆ·çš„é»˜è®¤æ ¹ç›®å½•éƒ½æ˜¯åœ¨ /Home ç›®å½•ä¸‹ï¼Œæ¯”å¦‚åˆšåˆšå‰é¢åˆ›å»ºçš„ `exampleuser` ç”¨æˆ·ï¼Œå®ƒå¯¹åº”çš„ Home ç›®å½•å°±ä¸º `/home/exampleuser`ï¼š

```
exampleuser:x:1003:1003::/home/exampleuser:/bin/sh
                         [----------------]
                                   |
                                   +----------------> Home ç›®å½•
```

å¦‚æœåœ¨åˆ›å»ºç”¨æˆ·æ—¶ä¸è¿›è¡Œæ˜ç¡®æŒ‡å®šï¼Œå®ƒçš„æ ¹ç›®å½•åç§°ä¸ç”¨æˆ·åä¸€è‡´ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šçœ‹åˆ° `exampleuser` ç”¨æˆ·å¯¹åº”çš„æ ¹ç›®å½•æ˜¯ `/home/exampleuser` è€Œä¸æ˜¯ `/home/example` çš„åŸå› ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥åœ¨åˆ›å»ºç”¨æˆ·æ—¶æ˜ç¡®è¿›è¡ŒæŒ‡å®šã€‚

å¦å¤–åˆ›å»ºçš„æ–°ç”¨æˆ·ä¹Ÿå¯ä»¥æŒ‡å®šä¸åˆ›å»ºå¯¹åº”çš„ Home ç›®å½•ã€‚ç¤ºä¾‹ï¼š

**åˆ›å»ºä¸å¸¦ Home ç›®å½•çš„ exampleNoHome ç”¨æˆ·**

```bash
useradd -M exampleNoHome
```

**æŸ¥çœ‹ /etc/passwd æ–‡ä»¶ä¸­è¯¥ç”¨æˆ·çš„ä¿¡æ¯ï¼š**

```
exampleNoHome:x:1003:1003::/home/exampleNoHome:/bin/sh
```

å¯ä»¥çœ‹åˆ°è™½ç„¶æŒ‡å®šäº†ä¸åˆ›å»º Home ç›®å½•ï¼Œè¿™é‡Œä¾ç„¶æ˜¾ç¤ºæœ‰ç›®å½•ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿåˆ‡æ¢åˆ°è¯¥ç”¨æˆ·è¿›å…¥ Home ç›®å½•è¯•è¯•ï¼š

**åˆ‡æ¢åˆ° exampleNoHome ç”¨æˆ·ï¼š**

```bash
$ su exampleNoHome

$ cd ~
sh: 3: cd: can't cd to /home/exampleNoHome   <=== è­¦å‘Šä¿¡æ¯
```

å½“æˆ‘ä»¬åˆ‡æ¢åˆ° exampleNoHome ç”¨æˆ·åå°è¯•è¿›å…¥ Home ç›®å½•æ—¶æç¤º Home ç›®å½•ä¸å­˜åœ¨ï¼


## æ“ä½œ Shell

è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„ Shell äº†ï¼Œæ¯”å¦‚ä¸Šé¢çš„ `exampleuser` ç”¨æˆ·å¯¹åº”çš„ Shell æ˜¯ `/bin/sh`ï¼š

```
exampleuser:x:1003:1003::/home/exampleuser:/bin/sh
                                           [-----]
                                              |
                                              +-------------> æ“ä½œ Shell
```

è¿™å°±æ˜¯è¯¥ç”¨æˆ·çš„é»˜è®¤ Shellï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåˆ‡æ¢åˆ°è¯¥ç”¨æˆ·èƒ½ä½¿ç”¨ Shell å‘½ä»¤çš„åŸå› ã€‚å¦å¤–ï¼Œå½“æˆ‘ä»¬æŸ¥çœ‹ç”¨æˆ·çš„é»˜è®¤ Shell æ—¶ä½ å°±ä¼šçœ‹åˆ°ä¸ `/etc/passwd` æ–‡ä»¶ä¸­çš„ Shell æ˜¯ä¸€è‡´çš„ï¼š

```bash
$ echo $SHELL
/bin/sh
```

æœ‰æ—¶ä½ ä¼šçœ‹åˆ°æŸä¸ªç”¨æˆ·åœ¨ `/etc/passwd` æ–‡ä»¶ä¸­çš„ Shell æ˜¯ nologinã€‚é‚£ä¹ˆè¯´æ˜è¯¥ç”¨æˆ·æ˜¯æ— æ³•ç™»å½•ç³»ç»Ÿçš„ï¼Œ**ç”šè‡³ä¹Ÿè¿ root ç”¨æˆ·ä¹Ÿæ— æ³•ä½¿ç”¨ `su` å‘½ä»¤åˆ‡æ¢åˆ°è¯¥ç”¨æˆ·**ï¼Œè¿™ç‚¹å¾ˆé‡è¦ï¼

ä¸‹é¢æ¥æ¼”ç¤ºä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º `examplenologin` çš„ç”¨æˆ·ï¼ŒåŒæ—¶æŒ‡å®šè¯¥ç”¨æˆ·çš„ Shell ä¸º `nologin`ï¼š

```bash
useradd -s /usr/sbin/nologin examplenologin
```

çœ‹ä¸‹ `/etc/passwd` æ–‡ä»¶ä¸­è¯¥ç”¨æˆ·çš„ Shell ä¿¡æ¯ï¼š

```
examplenologin:x:1001:1001::/home/examplenologin:/usr/sbin/nologin
                                                 [---------------]
                                                         |
                                                         +-------> nologin
```

ä¹‹åä½¿ç”¨ `chpasswd` å‘½ä»¤è®¾ç½®ä¸€ä¸ªç®€å•çš„å¯†ç  123456ï¼Œç”¨äºæµ‹è¯•ç™»å½•ï¼š

```bash
echo "examplenologin:123456" | chpasswd
```

ç°åœ¨ä½¿ç”¨ ssh ç™»å½•æœåŠ¡å™¨ï¼š

```bash
$ ssh examplenologin@172.17.21.163
examplenologin@172.17.21.163's password:
Linux vm 4.19.0-18-amd64 #1 SMP Debian 4.19.208-1 (2021-09-29) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Tue Nov 30 14:18:46 2021 from 172.17.13.43
Could not chdir to home directory /home/examplenologin: No such file or directory
This account is currently not available.         <=== æ³¨æ„è¿™é‡Œ
Connection to 172.17.21.163 closed.              <=== æ³¨æ„è¿™é‡Œ
```

å½“ä½ å°è¯•ç™»å½•æ—¶ä½ ä¼šå‘ç°æç¤ºä½ ï¼š`This account is currently not available`ï¼ä¹‹åå°±å…³é—­è¿æ¥äº†ã€‚

ç°åœ¨å†æµ‹è¯• `root` ç”¨æˆ·ä½¿ç”¨ `su` å‘½ä»¤åˆ‡æ¢åˆ°è¯¥ç”¨æˆ·ï¼š

```bash
$ su -l examplenologin
su: warning: cannot change directory to /home/examplenologin: No such file or directory
This account is currently not available.  <=== åŒæ ·çš„æç¤º
```

nologin Shell ç”¨æˆ·æ— æ³•ç™»å½•ä¹Ÿæ— æ³•ä½¿ç”¨ `su` åˆ‡æ¢ï¼Œé‚£ä¹ˆè¯¥ç”¨æˆ·å­˜åœ¨çš„æ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå› ä¸º Linux ç³»ç»Ÿä¸­æœ‰å¤§é‡çš„è¿™ç±»ç”¨æˆ·ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤çœ‹ä¸‹è¿™ç±»ç”¨æˆ·çš„ä¿¡æ¯ï¼š

```bash
$ grep nologin /etc/passwd
```

äº‹å®ä¸Šï¼Œè¿™ç±»ç”¨æˆ·é€šå¸¸æ˜¯ç³»ç»Ÿåˆ†é…ä»…ç”¨äºæ‰§è¡Œå°‘é‡å‘½ä»¤çš„ç”¨æˆ·ï¼Œæƒé™ç‰¹åˆ«ä½ï¼Œæ¯”å¦‚ç”¨äºé‚®ä»¶æœåŠ¡å™¨ã€‚æ‰€ä»¥åˆ’é‡ç‚¹ï¼Œ**nologin ç”¨æˆ·æ— æ³•ä½¿ç”¨ç”¨æˆ·åç™»å½•ç³»ç»Ÿï¼Œä¸”æ— æ³•ä½¿ç”¨ `su` å‘½ä»¤è¿›è¡Œåˆ‡æ¢**ï¼

å¦å¤–ï¼Œé™¤äº† nologin ä¹‹å¤–ï¼Œæœ‰å¯èƒ½è¿˜ä¼šçœ‹åˆ°æ“ä½œ Shell æ˜¯ /bin/falseã€‚æœ‰å…³è¿™ä¸ªçš„è¯å°±ä¸åšè§£é‡Šäº†ã€‚åœ¨ stackexchange ä¹Ÿæœ‰ä¸€ä¸ªå…³äºè¿™ä¸¤ä¸ª Shell åŒºåˆ«é—®é¢˜ï¼š[What's the difference between /sbin/nologin and /bin/false](https://unix.stackexchange.com/questions/10852/whats-the-difference-between-sbin-nologin-and-bin-false)ï¼Œå¯ä»¥è‡ªè¡Œå‚è€ƒä¸‹ã€‚


--

å‚è€ƒï¼šhttps://en.wikipedia.org/wiki/User_identifier

å®Œç»“ï¼Œæ’’èŠ±ğŸ‰ğŸ‰ğŸ‰~